{% extends "base.html" %}

{% block title %}Targets - Hiro{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
    <!-- Header and filters -->
    <div class="bg-white dark:bg-gray-800 rounded-lg shadow-sm border border-gray-200 dark:border-gray-700 p-4 mb-6">
        <div class="flex flex-wrap items-center gap-4">
            <!-- Search input -->
            <div class="flex-1 min-w-64">
                <div class="relative">
                    <input type="text"
                           data-search-input
                           placeholder="Search targets (host, title, or IP)..."
                           value="{{ search_query or '' }}"
                           class="w-full pl-10 pr-4 py-2 border border-gray-300 dark:border-gray-600 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-gray-700 dark:text-white"
                           hx-get="/api/targets"
                           hx-trigger="keyup changed delay:300ms"
                           hx-target="#target-list"
                           hx-indicator="#loading-indicator"
                           hx-vals='{"format": "html"}'
                           name="search">
                    <svg class="absolute left-3 top-2.5 h-5 w-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                </div>
            </div>

            <!-- Filter dropdowns -->
            <div class="flex flex-wrap gap-2">
                <select class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm dark:bg-gray-700 dark:text-white"
                        hx-get="/api/targets"
                        hx-trigger="change"
                        hx-target="#target-list"
                        hx-indicator="#loading-indicator"
                        hx-vals='{"format": "html"}'
                        hx-include="[name='search']"
                        name="status">
                    <option value="">All Status</option>
                    <option value="active" {% if current_status == 'active' %}selected{% endif %}>Active</option>
                    <option value="inactive" {% if current_status == 'inactive' %}selected{% endif %}>Inactive</option>
                    <option value="blocked" {% if current_status == 'blocked' %}selected{% endif %}>Blocked</option>
                    <option value="completed" {% if current_status == 'completed' %}selected{% endif %}>Completed</option>
                </select>

                <select class="px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-lg text-sm dark:bg-gray-700 dark:text-white"
                        hx-get="/api/targets"
                        hx-trigger="change"
                        hx-target="#target-list"
                        hx-indicator="#loading-indicator"
                        hx-vals='{"format": "html"}'
                        hx-include="[name='search'],[name='status']"
                        name="risk">
                    <option value="">All Risk Levels</option>
                    <option value="critical" {% if current_risk == 'critical' %}selected{% endif %}>Critical</option>
                    <option value="high" {% if current_risk == 'high' %}selected{% endif %}>High</option>
                    <option value="medium" {% if current_risk == 'medium' %}selected{% endif %}>Medium</option>
                    <option value="low" {% if current_risk == 'low' %}selected{% endif %}>Low</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Target grid -->
    <div id="target-list">
        {% include "components/target_list.html" %}
    </div>
</div>
{% endblock %}
